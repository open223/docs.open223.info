
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model Inference &#8212; ASHRAE Standard 223P User Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/model_inference';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Creating a Model with BuildingMOTIF" href="model_creation_buildingmotif.html" />
    <link rel="prev" title="Model Exploration" href="model_exploration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"> üèóÔ∏è this site is under active development ‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">ASHRAE Standard 223P User Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ASHRAE Standard 223 User Documentation 
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../explanation/purpose_scope.html">Purpose and Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/definitions.html">Definitions and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/223_overview.html">223 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/graph_structure.html">223 Graph Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/closed_world_assumption.html">Closed World Assumption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/heat_transfer_equipment.html">Heat Transfer Equipment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/medium_mixtures.html">Medium Mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/sensors_and_properties.html">Sensors and Properties</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="model_exploration.html">Model Exploration</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Model Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_creation_buildingmotif.html">Creating a Model with BuildingMOTIF</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../guides/design-patterns.html">Modeling Design Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/qudt.html">Using 223 with QUDT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/brick-rec.html">Using 223 with Brick and RealEstateCore</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/open223-resources.html">Open223 Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/other-resources.html">Other Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/open223/docs.open223.info/main?urlpath=tree/tutorials/model_inference.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/open223/docs.open223.info" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/open223/docs.open223.info/issues/new?title=Issue%20on%20page%20%2Ftutorials/model_inference.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorials/model_inference.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/tutorials/model_inference.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Model Inference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-shacl-rules">What are SHACL Rules?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-parsing">Model Parsing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-the-model-failed-query">Testing the Model (Failed Query)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-223-ontology">Loading the 223 Ontology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-inference-rules">Applying Inference Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-new-model">Using the New Model</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="model-inference">
<span id="id1"></span><h1>Model Inference<a class="headerlink" href="#model-inference" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The purpose of this tutorial is to show how SHACL inference applied to a 223 model can
make models easier to write and query. Specifically, this tutorial will teach the following:</p>
<ol class="arabic simple">
<li><p>How to load SHACL inference rules defined in the 223 ontology into memory</p></li>
<li><p>How to apply SHACL inference rules to a 223 model to add all ‚Äúimplied‚Äù triples</p></li>
</ol>
</div>
<p>For this tutorial, we‚Äôll use an existing equipment model of a variable air volume (VAV) terminal unit with cooling only from section 4.1 of ASHRAE Guideline 36-2021.
This and other example models are available from <a class="reference internal" href="../reference/open223-resources.html#open223-resources"><span class="std std-ref">Open223 Models</span></a>.</p>
<section id="what-are-shacl-rules">
<h2>What are SHACL Rules?<a class="headerlink" href="#what-are-shacl-rules" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://www.w3.org/TR/shacl-af/#rules">SHACL rules</a> add implied information to graphs if certain conditions are met, i.e. if certain triples exist in the source graph.
The process of applying rules to an input model to generate new information (triples) is called <em>inference</em>.
Inference makes models easier to write because the model author does not have to manually include all the triples necessary to support the desired queries;
instead, some of those useful triples can be added ‚Äúautomatically‚Äù to the model through the use of inferencing.
One way to think of inference is a way of normalizing a 223 model.
Inference assures that the expected properties, types, and other annotations are present so that consumers of the model can make assumptions about what information will be contained within the graph.</p>
</section>
<section id="model-parsing">
<h2>Model Parsing<a class="headerlink" href="#model-parsing" title="Link to this heading">#</a></h2>
<p>First, we‚Äôll create a new empty graph then parse (load) an existing graph into it using the Python RDFLib library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdflib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Graph</span>
<span class="c1"># Create a Graph</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="c1"># Parse in an RDF file hosted on the Internet</span>
<span class="n">model</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;https://models.open223.info/guideline36-2021-A-1.ttl&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;ttl&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2"> triples&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The model contains 101 triples
</pre></div>
</div>
</div>
</div>
<details>
<summary>Turtle representation of the model (pre-inference)</summary><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>@prefix g36: &lt;http://data.ashrae.org/standard223/1.0/extensions/g36#&gt; .
@prefix mysystem1: &lt;http://data.ashrae.org/standard223/1.0/data/guideline36-2021-A-1#&gt; .
@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt; .
@prefix qudt: &lt;http://qudt.org/schema/qudt/&gt; .
@prefix qudtqk: &lt;http://qudt.org/vocab/quantitykind/&gt; .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix s223: &lt;http://data.ashrae.org/standard223#&gt; .
@prefix unit: &lt;http://qudt.org/vocab/unit/&gt; .

mysystem1: a owl:Ontology ;
    rdfs:label &quot;&quot; ;
    owl:imports &lt;http://data.ashrae.org/standard223/1.0/model/all&gt; .

mysystem1:PhysicalSpace a s223:PhysicalSpace ;
    rdfs:label &quot;Physicalspace&quot; ;
    s223:encloses mysystem1:PhysicalSpace-hvac-domain .

mysystem1:VAVCoolingOnly a s223:SingleDuctTerminal,
        g36:VAV ;
    rdfs:label &quot;Vavcoolingonly&quot; ;
    s223:cnx mysystem1:VAVCoolingOnly-in,
        mysystem1:VAVCoolingOnly-out ;
    s223:contains mysystem1:VAVCoolingOnly-damper .

mysystem1:VAVCoolingOnly-damper-actuator a s223:Actuator ;
    rdfs:label &quot;Vavcoolingonly Damper Actuator&quot; ;
    s223:actuatedByProperty mysystem1:VAVCoolingOnly-damper-command ;
    s223:actuates mysystem1:VAVCoolingOnly-damper .

mysystem1:VAVCoolingOnly-discharge-air-flow-sensor a s223:Sensor ;
    rdfs:label &quot;Vavcoolingonly Discharge Air Flow Sensor&quot; ;
    s223:hasObservationLocation mysystem1:VAVCoolingOnly-out ;
    s223:observes mysystem1:VAVCoolingOnly-discharge-air-flow .

mysystem1:VAVCoolingOnly-duct-after-damper a s223:Connection,
        s223:Duct ;
    rdfs:label &quot;Vavcoolingonly Duct After Damper&quot; ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:VAVCoolingOnly-duct-before-damper a s223:Connection,
        s223:Duct ;
    rdfs:label &quot;Vavcoolingonly Duct Before Damper&quot; ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:zone a s223:Zone,
        g36:Zone ;
    rdfs:label &quot;Zone&quot; ;
    s223:hasDomain s223:Domain-HVAC ;
    s223:hasDomainSpace mysystem1:PhysicalSpace-hvac-domain ;
    s223:hasProperty mysystem1:zone-co2-concentration,
        mysystem1:zone-temp .

mysystem1:PhysicalSpace-hvac-domain-in a s223:InletConnectionPoint ;
    rdfs:label &quot;Physicalspace Hvac Domain In&quot; ;
    s223:cnx mysystem1:vav-supply-to-room-connection ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:PhysicalSpace-hvac-domain-out a s223:OutletConnectionPoint ;
    rdfs:label &quot;Physicalspace Hvac Domain Out&quot; ;
    s223:cnx mysystem1:room-return-to-vav-connection ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:VAVCoolingOnly-damper-in a s223:InletConnectionPoint ;
    rdfs:label &quot;Vavcoolingonly Damper In&quot; ;
    s223:hasMedium s223:Fluid-Air ;
    s223:mapsTo mysystem1:VAVCoolingOnly-in .

mysystem1:VAVCoolingOnly-damper-out a s223:OutletConnectionPoint ;
    rdfs:label &quot;Vavcoolingonly Damper Out&quot; ;
    s223:hasMedium s223:Fluid-Air ;
    s223:mapsTo mysystem1:VAVCoolingOnly-out .

mysystem1:VAVCoolingOnly-damper-position a s223:QuantifiableObservableProperty ;
    rdfs:label &quot;Vavcoolingonly Damper Position&quot; ;
    qudt:hasQuantityKind qudtqk:DimensionlessRatio ;
    qudt:hasUnit unit:PERCENT .

mysystem1:zone-co2-concentration a s223:QuantifiableObservableProperty ;
    rdfs:label &quot;Zone Co2 Concentration&quot; ;
    s223:ofSubstance s223:Constituent-CO2 ;
    qudt:hasQuantityKind qudtqk:MoleFraction ;
    qudt:hasUnit unit:PPM .

mysystem1:zone-temp a s223:QuantifiableObservableProperty ;
    rdfs:label &quot;Zone Temp&quot; ;
    qudt:hasQuantityKind qudtqk:Temperature ;
    qudt:hasUnit unit:DEG_C .

mysystem1:PhysicalSpace-hvac-domain a s223:DomainSpace ;
    rdfs:label &quot;Physicalspace Hvac Domain&quot; ;
    s223:cnx mysystem1:PhysicalSpace-hvac-domain-in,
        mysystem1:PhysicalSpace-hvac-domain-out ;
    s223:hasDomain s223:Domain-HVAC .

mysystem1:VAVCoolingOnly-damper a s223:Damper,
        g36:Damper ;
    rdfs:label &quot;Vavcoolingonly Damper&quot; ;
    s223:cnx mysystem1:VAVCoolingOnly-damper-in,
        mysystem1:VAVCoolingOnly-damper-out ;
    s223:hasProperty mysystem1:VAVCoolingOnly-damper-command,
        mysystem1:VAVCoolingOnly-damper-position .

mysystem1:VAVCoolingOnly-damper-command a s223:QuantifiableActuatableProperty ;
    rdfs:label &quot;Vavcoolingonly Damper Command&quot; ;
    s223:hasAspect s223:EnumerationKind-Position ;
    qudt:hasQuantityKind qudtqk:DimensionlessRatio ;
    qudt:hasUnit unit:PERCENT .

mysystem1:VAVCoolingOnly-discharge-air-flow a s223:QuantifiableObservableProperty ;
    rdfs:label &quot;Vavcoolingonly Discharge Air Flow&quot; ;
    s223:hasAspect s223:Role-Discharge ;
    qudt:hasQuantityKind qudtqk:VolumeFlowRate ;
    qudt:hasUnit unit:FT3-PER-MIN .

mysystem1:VAVCoolingOnly-in a s223:InletConnectionPoint ;
    rdfs:label &quot;Vavcoolingonly In&quot; ;
    s223:cnx mysystem1:room-return-to-vav-connection ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:room-return-to-vav-connection a s223:Connection ;
    rdfs:label &quot;Room Return To Vav Connection&quot; ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:vav-supply-to-room-connection a s223:Connection ;
    rdfs:label &quot;Vav Supply To Room Connection&quot; ;
    s223:hasMedium s223:Fluid-Air .

mysystem1:VAVCoolingOnly-out a s223:OutletConnectionPoint ;
    rdfs:label &quot;Vavcoolingonly Out&quot; ;
    s223:cnx mysystem1:vav-supply-to-room-connection ;
    s223:hasMedium s223:Fluid-Air ;
    s223:hasProperty mysystem1:VAVCoolingOnly-discharge-air-flow .
</pre></div>
</div>
</div>
</div>
</details>
<section id="testing-the-model-failed-query">
<h3>Testing the Model (Failed Query)<a class="headerlink" href="#testing-the-model-failed-query" title="Link to this heading">#</a></h3>
<p>Below, we try to run a simple query on our model which asks what the terminal unit is connected to.
The <code class="docutils literal notranslate"><span class="pre">s223:connected</span></code> relationship does not exist in the pre-inference model, so this query will not return results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parts_query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">PREFIX bldg: &lt;http://data.ashrae.org/standard223/1.0/data/guideline36-2021-A-1#&gt;</span>
<span class="s2">PREFIX s223: &lt;http://data.ashrae.org/standard223#&gt;</span>
<span class="s2">SELECT ?physical_space WHERE {</span>
<span class="s2">    bldg:VAVCoolingOnly s223:connected ?physical_space .</span>
<span class="s2">}&quot;&quot;&quot;</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">parts_query</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="loading-the-223-ontology">
<h2>Loading the 223 Ontology<a class="headerlink" href="#loading-the-223-ontology" title="Link to this heading">#</a></h2>
<p>The 223 ontology contains the rules we will use for inference.
We will load the 223 ontology into a separate graph from the model.
This is mostly for maintenance: it is easy enough to merge two graphs together into one, but it is much harder to factor them out again.
By keeping the ontology graph separate from the model graph, we can more easily maintain and version those graphs individually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdflib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Graph</span>
<span class="c1"># Create a Graph</span>
<span class="n">s223</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="c1"># Parse in a recent copy of the 223 ontology</span>
<span class="n">s223</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;https://query.open223.info/ontologies/223p.ttl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Graph identifier=N08160f5a10c349e8a0f069c4aa2b6533 (&lt;class &#39;rdflib.graph.Graph&#39;&gt;)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="applying-inference-rules">
<h2>Applying Inference Rules<a class="headerlink" href="#applying-inference-rules" title="Link to this heading">#</a></h2>
<p>To apply inference rules, we need an <em>inference engine</em>.
This is a piece of software which knows how to properly interpret and apply the SHACL rules defined in an ontology.
There are multiple closed-source and open-source implementations of SHACL available; some of these are listed on <a class="reference internal" href="../reference/other-resources.html#other-resources"><span class="std std-ref">this page</span></a>
Below, we will be using the open-source <a class="reference external" href="https://github.com/RDFLib/pySHACL">PySHACL</a> library.</p>
<p>We import the PySHACL library and then invoke the <code class="docutils literal notranslate"><span class="pre">validate</span></code> function on our model graph (<em>data graph</em> in PySHACL parlance)
and our 223 graph (<em>shape graph</em> in PySHACL parlance).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyshacl</span>

<span class="n">combined</span> <span class="o">=</span> <span class="n">model</span><span class="o">+</span><span class="n">s223</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">pyshacl</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span>
        <span class="n">allow_infos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>     <span class="c1"># don&#39;t fail if we get an INFO message</span>
        <span class="n">allow_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># don&#39;t fail if we get a WARNING message</span>
        <span class="n">abort_on_first</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># allow errors to happen during execution</span>
        <span class="n">advanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># allow SHACL rules to execute</span>
        <span class="n">iterate_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># allow rules to be applied multiple times</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>          <span class="c1"># update the &#39;model&#39; object with the inferred triples</span>
    <span class="p">)</span>
<span class="c1"># remove the s223 graph from the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">combined</span> <span class="o">-</span> <span class="n">s223</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The model now contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2"> triples&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">combined</span> <span class="o">=</span> <span class="n">model</span><span class="o">+</span><span class="n">s223</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="n">pyshacl</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>         <span class="n">allow_infos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>     <span class="c1"># don&#39;t fail if we get an INFO message</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">allow_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># don&#39;t fail if we get a WARNING message</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="n">abort_on_first</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># allow errors to happen during execution</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="n">advanced</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># allow SHACL rules to execute</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>         <span class="n">iterate_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># allow rules to be applied multiple times</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>          <span class="c1"># update the &#39;model&#39; object with the inferred triples</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="c1"># remove the s223 graph from the model</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="n">model</span> <span class="o">=</span> <span class="n">combined</span> <span class="o">-</span> <span class="n">s223</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/entrypoints.py:178,</span> in <span class="ni">validate</span><span class="nt">(data_graph, shacl_graph, ont_graph, advanced, inference, inplace, abort_on_first, allow_infos, allow_warnings, max_validation_depth, sparql_mode, focus_nodes, use_shapes, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>     <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>         <span class="n">loaded_dg</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>         <span class="n">shacl_graph</span><span class="o">=</span><span class="n">loaded_sg</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>         <span class="n">ont_graph</span><span class="o">=</span><span class="n">loaded_og</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span>         <span class="n">options</span><span class="o">=</span><span class="n">validator_options_dict</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">178</span>     <span class="n">conforms</span><span class="p">,</span> <span class="n">report_graph</span><span class="p">,</span> <span class="n">report_text</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span> <span class="k">except</span> <span class="n">ValidationFailure</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>     <span class="n">conforms</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/validator.py:315,</span> in <span class="ni">Validator.run</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>     <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">315</span>         <span class="n">_is_conform</span><span class="p">,</span> <span class="n">_reports</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">focus</span><span class="o">=</span><span class="n">on_focus_nodes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>         <span class="n">non_conformant</span> <span class="o">=</span> <span class="n">non_conformant</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">_is_conform</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span>         <span class="n">reports</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_reports</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/shape.py:772,</span> in <span class="ni">Shape.validate</span><span class="nt">(self, executor, target_graph, focus, _evaluation_path)</span>
<span class="g g-Whitespace">    </span><span class="mi">770</span>     <span class="n">path_str</span> <span class="o">=</span> <span class="s2">&quot; -&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">_e_p_copy</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">771</span>     <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current constraint evaluation path: </span><span class="si">{</span><span class="n">path_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">772</span> <span class="n">_is_conform</span><span class="p">,</span> <span class="n">_reports</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">executor</span><span class="p">,</span> <span class="n">target_graph</span><span class="p">,</span> <span class="n">focus_value_nodes</span><span class="p">,</span> <span class="n">_e_p_copy</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">773</span> <span class="k">if</span> <span class="n">executor</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">774</span>     <span class="k">if</span> <span class="n">collect_stats</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/constraints/sparql/sparql_based_constraints.py:108,</span> in <span class="ni">SPARQLBasedConstraint.evaluate</span><span class="nt">(self, executor, target_graph, focus_value_nodes, _evaluation_path)</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> <span class="k">if</span> <span class="n">query_helper</span><span class="o">.</span><span class="n">deactivated</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span>     <span class="k">continue</span>
<span class="ne">--&gt; </span><span class="mi">108</span> <span class="n">_nc</span><span class="p">,</span> <span class="n">_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evaluate_sparql_constraint</span><span class="p">(</span><span class="n">query_helper</span><span class="p">,</span> <span class="n">target_graph</span><span class="p">,</span> <span class="n">focus_value_nodes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="n">non_conformant</span> <span class="o">=</span> <span class="n">non_conformant</span> <span class="ow">or</span> <span class="n">_nc</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span> <span class="n">reports</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_r</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/constraints/sparql/sparql_based_constraints.py:125,</span> in <span class="ni">SPARQLBasedConstraint._evaluate_sparql_constraint</span><span class="nt">(self, sparql_constraint, target_graph, f_v_dict)</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span> <span class="n">sparql_text</span> <span class="o">=</span> <span class="n">sparql_constraint</span><span class="o">.</span><span class="n">apply_prefixes</span><span class="p">(</span><span class="n">sparql_text</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">125</span>     <span class="n">violating_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_sparql_query</span><span class="p">(</span><span class="n">sparql_text</span><span class="p">,</span> <span class="n">init_binds</span><span class="p">,</span> <span class="n">target_graph</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span> <span class="k">except</span> <span class="n">ValidationFailure</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>     <span class="k">raise</span> <span class="n">e</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/constraints/sparql/sparql_based_constraints.py:171,</span> in <span class="ni">SPARQLBasedConstraint._validate_sparql_query</span><span class="nt">(self, query, init_binds, target_graph)</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span> <span class="k">def</span><span class="w"> </span><span class="nf">_validate_sparql_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">init_binds</span><span class="p">,</span> <span class="n">target_graph</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>     <span class="n">results</span> <span class="o">=</span> <span class="n">target_graph</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">initBindings</span><span class="o">=</span><span class="n">init_binds</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">171</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">bindings</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>         <span class="k">return</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="n">violations</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/query.py:356,</span> in <span class="ni">Result.__bool__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">askAnswer</span>  <span class="c1"># type: ignore[return-value]</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">356</span>     <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/query.py:346,</span> in <span class="ni">Result.__len__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>     <span class="k">return</span> <span class="mi">1</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span> <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;SELECT&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">346</span>     <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bindings</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">348</span>     <span class="c1"># type error: Argument 1 to &quot;len&quot; has incompatible type &quot;Optional[Graph]&quot;; expected &quot;Sized&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">349</span>     <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/query.py:240,</span> in <span class="ni">Result.bindings</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">237</span><span class="sd"> a list of variable bindings as dicts</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_genbindings</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">240</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_bindings</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_genbindings</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">241</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_genbindings</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bindings</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evaluate.py:574,</span> in <span class="ni">&lt;genexpr&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span> <span class="k">def</span><span class="w"> </span><span class="nf">evalProject</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">QueryContext</span><span class="p">,</span> <span class="n">project</span><span class="p">:</span> <span class="n">CompValue</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">573</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">evalPart</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">project</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">574</span>     <span class="k">return</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">project</span><span class="o">.</span><span class="n">PV</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">res</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evaluate.py:214,</span> in <span class="ni">evalFilter</span><span class="nt">(ctx, part)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span> <span class="k">def</span><span class="w"> </span><span class="nf">evalFilter</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>     <span class="n">ctx</span><span class="p">:</span> <span class="n">QueryContext</span><span class="p">,</span> <span class="n">part</span><span class="p">:</span> <span class="n">CompValue</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FrozenBindings</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>     <span class="c1"># TODO: Deal with dict returned from evalPart!</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span>     <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">evalPart</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">p</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">214</span>         <span class="k">if</span> <span class="n">_ebv</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>             <span class="n">part</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>             <span class="n">c</span><span class="o">.</span><span class="n">forget</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">_except</span><span class="o">=</span><span class="n">part</span><span class="o">.</span><span class="n">_vars</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">part</span><span class="o">.</span><span class="n">no_isolated_scope</span> <span class="k">else</span> <span class="n">c</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span>         <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>             <span class="k">yield</span> <span class="n">c</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evalutils.py:88,</span> in <span class="ni">_ebv</span><span class="nt">(expr, ctx)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Expr</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">88</span>         <span class="k">return</span> <span class="n">EBV</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span>     <span class="k">except</span> <span class="n">SPARQLError</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span>         <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># filter error == False</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:226,</span> in <span class="ni">Expr.eval</span><span class="nt">(self, ctx)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">,</span> <span class="n">FrozenBindings</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ctx</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># type error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evalfn</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="k">except</span> <span class="n">SPARQLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="k">return</span> <span class="n">e</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/operators.py:934,</span> in <span class="ni">ConditionalAndExpression</span><span class="nt">(e, ctx)</span>
<span class="g g-Whitespace">    </span><span class="mi">928</span> <span class="k">def</span><span class="w"> </span><span class="nf">ConditionalAndExpression</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">929</span>     <span class="n">e</span><span class="p">:</span> <span class="n">Expr</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">QueryContext</span><span class="p">,</span> <span class="n">FrozenBindings</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">930</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Literal</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">931</span>     <span class="c1"># TODO: handle returned errors</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span>     <span class="n">expr</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">expr</span>
<span class="ne">--&gt; </span><span class="mi">934</span>     <span class="n">other</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">other</span>
<span class="g g-Whitespace">    </span><span class="mi">936</span>     <span class="c1"># because of the way the add-expr production handled operator precedence</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="c1"># we sometimes have nothing to do</span>
<span class="g g-Whitespace">    </span><span class="mi">938</span>     <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:195,</span> in <span class="ni">CompValue.__getattr__</span><span class="nt">(self, a)</span>
<span class="g g-Whitespace">    </span><span class="mi">193</span>     <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">195</span>     <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span>     <span class="c1"># raise AttributeError(&#39;no such attribute &#39;+a)</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span>     <span class="k">return</span> <span class="kc">None</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:183,</span> in <span class="ni">CompValue.__getitem__</span><span class="nt">(self, a)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span> <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">183</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">(</span><span class="n">OrderedDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:178,</span> in <span class="ni">CompValue._value</span><span class="nt">(self, val, variables, errors)</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span> <span class="k">def</span><span class="w"> </span><span class="nf">_value</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>     <span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">_ValT</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">_ValT</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">178</span>         <span class="k">return</span> <span class="n">value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>         <span class="k">return</span> <span class="n">val</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:81,</span> in <span class="ni">value</span><span class="nt">(ctx, val, variables, errors)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;What do I do with this CompValue? </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">val</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="k">return</span> <span class="p">[</span><span class="n">value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="n">BNode</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:76,</span> in <span class="ni">value</span><span class="nt">(ctx, val, variables, errors)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span><span class="sd"> utility function for evaluating something...</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span><span class="sd"> </span>
<span class="sd">   (...)     72 </span>
<span class="g g-Whitespace">     </span><span class="mi">73</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Expr</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">76</span>     <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>  <span class="c1"># recurse?</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">CompValue</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;What do I do with this CompValue? </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">val</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/parserutils.py:226,</span> in <span class="ni">Expr.eval</span><span class="nt">(self, ctx)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Mapping</span><span class="p">,</span> <span class="n">FrozenBindings</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ctx</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># type error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evalfn</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="k">except</span> <span class="n">SPARQLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="k">return</span> <span class="n">e</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/operators.py:588,</span> in <span class="ni">Builtin_EXISTS</span><span class="nt">(e, ctx)</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">thaw</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment] # hmm</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="c1"># type error: Argument 1 to &quot;evalPart&quot; has incompatible type &quot;FrozenBindings&quot;; expected &quot;QueryContext&quot;</span>
<span class="ne">--&gt; </span><span class="mi">588</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evalPart</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">589</span>     <span class="k">return</span> <span class="n">Literal</span><span class="p">(</span><span class="n">exists</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">590</span> <span class="k">return</span> <span class="n">Literal</span><span class="p">(</span><span class="ow">not</span> <span class="n">exists</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evaluate.py:297,</span> in <span class="ni">evalPart</span><span class="nt">(ctx, part)</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>     <span class="k">return</span> <span class="n">evalFilter</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span> <span class="k">elif</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Join&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">297</span>     <span class="k">return</span> <span class="n">evalJoin</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">298</span> <span class="k">elif</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;LeftJoin&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="k">return</span> <span class="n">evalLeftJoin</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evaluate.py:165,</span> in <span class="ni">evalJoin</span><span class="nt">(ctx, join)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">evalPart</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">join</span><span class="o">.</span><span class="n">p1</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">165</span>     <span class="n">b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">evalPart</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">join</span><span class="o">.</span><span class="n">p2</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span>     <span class="k">return</span> <span class="n">_join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/sparql/evaluate.py:97,</span> in <span class="ni">evalBGP</span><span class="nt">(ctx, bgp)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span> <span class="n">_o</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span> <span class="c1"># type error: Item &quot;None&quot; of &quot;Optional[Graph]&quot; has no attribute &quot;triples&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span> <span class="c1"># type Argument 1 to &quot;triples&quot; of &quot;Graph&quot; has incompatible type &quot;Tuple[Union[str, Path, None], Union[str, Path, None], Union[str, Path, None]]&quot;; expected &quot;Tuple[Optional[Node], Optional[Node], Optional[Node]]&quot;</span>
<span class="ne">---&gt; </span><span class="mi">97</span> <span class="k">for</span> <span class="n">ss</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">so</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">triples</span><span class="p">((</span><span class="n">_s</span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n">_o</span><span class="p">)):</span>  <span class="c1"># type: ignore[union-attr, arg-type]</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>     <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n">_o</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>         <span class="n">c</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/graph.py:635,</span> in <span class="ni">Graph.triples</span><span class="nt">(self, triple)</span>
<span class="g g-Whitespace">    </span><span class="mi">633</span> <span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">triple</span>
<span class="g g-Whitespace">    </span><span class="mi">634</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">635</span>     <span class="k">for</span> <span class="n">_s</span><span class="p">,</span> <span class="n">_o</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span>         <span class="k">yield</span> <span class="n">_s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_o</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:313,</span> in <span class="ni">SequencePath.eval.&lt;locals&gt;._eval_seq_bw</span><span class="nt">(paths, subj, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> <span class="k">if</span> <span class="n">paths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>     <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">eval_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">obj</span><span class="p">)):</span>
<span class="ne">--&gt; </span><span class="mi">313</span>         <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">_eval_seq</span><span class="p">(</span><span class="n">paths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">subj</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>             <span class="k">yield</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">o</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:299,</span> in <span class="ni">SequencePath.eval.&lt;locals&gt;._eval_seq</span><span class="nt">(paths, subj, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span> <span class="k">if</span> <span class="n">paths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="g g-Whitespace">    </span><span class="mi">298</span>     <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">eval_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">)):</span>
<span class="ne">--&gt; </span><span class="mi">299</span>         <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">_eval_seq</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>             <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:298,</span> in <span class="ni">SequencePath.eval.&lt;locals&gt;._eval_seq</span><span class="nt">(paths, subj, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span> <span class="k">def</span><span class="w"> </span><span class="nf">_eval_seq</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">293</span>     <span class="n">paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">]],</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>     <span class="n">subj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_SubjectType</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>     <span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ObjectType</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_SubjectType</span><span class="p">,</span> <span class="n">_ObjectType</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span>     <span class="k">if</span> <span class="n">paths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="ne">--&gt; </span><span class="mi">298</span>         <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">eval_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>             <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">_eval_seq</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>                 <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:566,</span> in <span class="ni">&lt;genexpr&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span> <span class="k">def</span><span class="w"> </span><span class="nf">eval_path</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>     <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>     <span class="n">t</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">564</span>     <span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_SubjectType</span><span class="p">,</span> <span class="n">_ObjectType</span><span class="p">]]:</span>
<span class="nn">--&gt; 566     return ((s, o) for s, p, o</span> in <span class="ni">graph.triples</span><span class="nt">(t))</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/graph.py:635,</span> in <span class="ni">Graph.triples</span><span class="nt">(self, triple)</span>
<span class="g g-Whitespace">    </span><span class="mi">633</span> <span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">triple</span>
<span class="g g-Whitespace">    </span><span class="mi">634</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">635</span>     <span class="k">for</span> <span class="n">_s</span><span class="p">,</span> <span class="n">_o</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span>         <span class="k">yield</span> <span class="n">_s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_o</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:462,</span> in <span class="ni">MulPath.eval</span><span class="nt">(self, graph, subj, obj, first)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span> <span class="n">done</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># the spec does, by defn, not allow duplicates</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span> <span class="k">if</span> <span class="n">subj</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">462</span>     <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_fwd</span><span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>         <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>             <span class="n">done</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:409,</span> in <span class="ni">MulPath.eval.&lt;locals&gt;._fwd</span><span class="nt">(subj, obj, seen)</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span>     <span class="k">continue</span>
<span class="ne">--&gt; </span><span class="mi">409</span> <span class="k">for</span> <span class="n">s2</span><span class="p">,</span> <span class="n">o2</span> <span class="ow">in</span> <span class="n">_fwd</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">seen</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>     <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">o2</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:409,</span> in <span class="ni">MulPath.eval.&lt;locals&gt;._fwd</span><span class="nt">(subj, obj, seen)</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>  <span class="c1"># type: ignore[operator]</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span>     <span class="k">continue</span>
<span class="ne">--&gt; </span><span class="mi">409</span> <span class="k">for</span> <span class="n">s2</span><span class="p">,</span> <span class="n">o2</span> <span class="ow">in</span> <span class="n">_fwd</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">seen</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>     <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">o2</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:402,</span> in <span class="ni">MulPath.eval.&lt;locals&gt;._fwd</span><span class="nt">(subj, obj, seen)</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span> <span class="k">def</span><span class="w"> </span><span class="nf">_fwd</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">394</span>     <span class="n">subj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_SubjectType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span>     <span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ObjectType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">398</span>     <span class="c1"># type error: Item &quot;None&quot; of &quot;Optional[Set[Node]]&quot; has no attribute &quot;add&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span>     <span class="c1"># type error: Argument 1 to &quot;add&quot; of &quot;set&quot; has incompatible type &quot;Optional[Node]&quot;; expected &quot;Node&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">subj</span><span class="p">)</span>  <span class="c1"># type: ignore[union-attr, arg-type]</span>
<span class="ne">--&gt; </span><span class="mi">402</span>     <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">eval_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">obj</span> <span class="ow">or</span> <span class="n">o</span> <span class="o">==</span> <span class="n">obj</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>             <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/paths.py:566,</span> in <span class="ni">&lt;genexpr&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span> <span class="k">def</span><span class="w"> </span><span class="nf">eval_path</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>     <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>     <span class="n">t</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>    <span class="mi">564</span>     <span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">565</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_SubjectType</span><span class="p">,</span> <span class="n">_ObjectType</span><span class="p">]]:</span>
<span class="nn">--&gt; 566     return ((s, o) for s, p, o</span> in <span class="ni">graph.triples</span><span class="nt">(t))</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/graph.py:638,</span> in <span class="ni">Graph.triples</span><span class="nt">(self, triple)</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span>         <span class="k">yield</span> <span class="n">_s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_o</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">638</span>     <span class="k">for</span> <span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n">_o</span><span class="p">),</span> <span class="n">cg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__store</span><span class="o">.</span><span class="n">triples</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">o</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span>         <span class="k">yield</span> <span class="n">_s</span><span class="p">,</span> <span class="n">_p</span><span class="p">,</span> <span class="n">_o</span>

<span class="nn">File ~/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/rdflib/plugins/stores/memory.py:417,</span> in <span class="ni">Memory.triples</span><span class="nt">(self, triple_pattern, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">409</span>     <span class="k">if</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>         <span class="n">triple_pattern</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">411</span>         <span class="ow">and</span> <span class="n">context</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all_contexts</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span>         <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_aware</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span>     <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>         <span class="c1"># remove the whole context</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span>         <span class="bp">self</span><span class="o">.</span><span class="n">__all_contexts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">417</span> <span class="k">def</span><span class="w"> </span><span class="nf">triples</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">419</span>     <span class="n">triple_pattern</span><span class="p">:</span> <span class="n">_TriplePatternType</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">420</span>     <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_ContextType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">421</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span>
<span class="g g-Whitespace">    </span><span class="mi">422</span>     <span class="n">Tuple</span><span class="p">[</span><span class="n">_TripleType</span><span class="p">,</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">_ContextType</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span>     <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span>     <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">425</span> <span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;A generator over all the triples matching&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span>     <span class="n">req_ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ctx_to_str</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>This may take a few minutes to run, depending on the size of your model.
If the PySHACL library is too slow, we recommend looking at alternate open-source implementations
like <a class="reference external" href="https://github.com/TopQuadrant/shacl">TopQuadrant‚Äôs Java-based implementation</a>.</p>
<p>We can see from the print statement that several triples have been added to the model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyshacl.validate</span></code> function actually returns a SHACL validation report which can be used to fix
the model and make it compatible with the 223 ontology. See the <a class="reference internal" href="#model_validation"><span class="xref myst">Model Validation</span></a>
tutorial for how to access and interpret this report.</p>
</div>
<details>
<summary>Turtle representation of the model (post-inference)</summary><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</details>
</section>
<section id="using-the-new-model">
<h2>Using the New Model<a class="headerlink" href="#using-the-new-model" title="Link to this heading">#</a></h2>
<p>To demonstrate that the model contains new triples, we can try re-running the query from before.
We can see that the query returns results this time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">PREFIX bldg: &lt;http://data.ashrae.org/standard223/1.0/data/guideline36-2021-A-1#&gt;</span>
<span class="s2">PREFIX s223: &lt;http://data.ashrae.org/standard223#&gt;</span>
<span class="s2">SELECT ?physical_space WHERE {</span>
<span class="s2">    bldg:VAVCoolingOnly s223:connected ?physical_space .</span>
<span class="s2">}&quot;&quot;&quot;</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "open223/docs.open223.info",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "open223-book"
        },
        kernelOptions: {
            name: "open223-book",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'open223-book'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="model_exploration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model Exploration</p>
      </div>
    </a>
    <a class="right-next"
       href="model_creation_buildingmotif.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Creating a Model with BuildingMOTIF</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-shacl-rules">What are SHACL Rules?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-parsing">Model Parsing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-the-model-failed-query">Testing the Model (Failed Query)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-223-ontology">Loading the 223 Ontology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-inference-rules">Applying Inference Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-new-model">Using the New Model</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>