{"version":3,"kind":"Notebook","sha256":"8755ad5579282a31306cd79741f1ea5ec24bc038f4f87fe93f16c6fb0f5991e0","slug":"model-creation-buildingmotif","location":"/tutorials/model_creation_buildingmotif.md","dependencies":[],"frontmatter":{"title":"Creating a Model with BuildingMOTIF","kernelspec":{"name":"open223-book","display_name":"open223-book","language":"python"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst"}},"content_includes_title":false,"github":"https://github.com/open223/docs.open223.info","numbering":{"title":{"offset":1}},"source_url":"https://github.com/open223/docs.open223.info/blob/main/tutorials/model_creation_buildingmotif.md","edit_url":"https://github.com/open223/docs.open223.info/edit/main/tutorials/model_creation_buildingmotif.md","exports":[{"format":"md","filename":"model_creation_buildingmotif.md","url":"/build/model_creation_build-7379c579f5d3db0fe148145ea1fd1bf2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://github.com/NREL/BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"TTf34b5H6L"}],"urlSource":"https://github.com/NREL/BuildingMOTIF","error":true,"key":"TNd8XmSLST"},{"type":"text","value":" is a Python SDK for creating, manipulating, and validating semantic building models.\nHere, we will demonstrate how to create a simple ASHRAE 223P model using BuildingMOTIF.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"H4UcVtknZX"}],"key":"fKitUn4zMj"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"We will create a model that includes a simple HVAC system with a VAV terminal unit serving a zone.\nThis will use BuildingMOTIF ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"kYSNsMoYYc"},{"type":"link","url":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Templates","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wIxXujWIXO"}],"urlSource":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","key":"pSjbhixLQH"},{"type":"text","value":", which are reusable components that encapsulate common patterns in building modeling.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"cZGPf5LdZk"}],"key":"TLTZRXShES"},{"type":"heading","depth":2,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Setting up BuildingMOTIF","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"kuN9BiM30L"}],"identifier":"setting-up-buildingmotif","label":"Setting up BuildingMOTIF","html_id":"setting-up-buildingmotif","implicit":true,"key":"m1Ca4q1clR"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Downloading the NREL 223P templates library","key":"gRfGvW2v7m"}],"key":"IPt8B59PZM"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"!git clone --filter=blob:none --no-checkout https://github.com/NREL/BuildingMOTIF\n!pushd BuildingMOTIF && git sparse-checkout init --cone\n!pushd BuildingMOTIF && git sparse-checkout set libraries/ashrae/223p/nrel-templates\n!pushd BuildingMOTIF && git checkout","key":"CLVXUB64nE"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"LfORO3HrEm"},{"type":"div","class":"output","children":[],"key":"OfYZzS6yNq"},{"type":"div","class":"output","children":[],"key":"PB39oDxI0I"},{"type":"div","class":"output","children":[],"key":"N7izD3LOms"},{"type":"div","class":"output","children":[],"key":"vPENKBX7lB"},{"type":"div","class":"output","children":[],"key":"UxYX5exP8B"},{"type":"div","class":"output","children":[],"key":"LuscPSxX2k"},{"type":"div","class":"output","children":[],"key":"hMSZ4fdai5"},{"type":"div","class":"output","children":[],"key":"R16DYzMkRv"},{"type":"div","class":"output","children":[],"key":"tehIoe7g8z"},{"type":"div","class":"output","children":[],"key":"chHNKWrPs6"},{"type":"div","class":"output","children":[],"key":"IxgcpwGI3a"},{"type":"div","class":"output","children":[],"key":"Dz4HTVaeDq"},{"type":"div","class":"output","children":[],"key":"D1jrW3yHzN"},{"type":"div","class":"output","children":[],"key":"dyrQtVvmJD"},{"type":"div","class":"output","children":[],"key":"veo4xIxVL9"},{"type":"div","class":"output","children":[],"key":"sTFcdvyfn4"}],"key":"gROStGsIj4"}],"key":"A4aIJTEEDK"}],"key":"aFQdSbCnGX"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The following code sets up a temporary (in-memory) BuildingMOTIF instance, loads the necessary libraries, and creates an (empty) model to hold our building data.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"R8hru5ifJl"}],"key":"Iq3xtRfLnP"}],"key":"Ebi19ETRAR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from rdflib import Namespace\nfrom buildingmotif import BuildingMOTIF\nfrom buildingmotif.dataclasses import Library, Model\nfrom buildingmotif.model_builder import TemplateBuilderContext as ModelBuilder\nimport logging\n\n# Create a BuildingMOTIF object. If you do not have Java installed, remove the \"shacl_engine\" parameter\nbm = BuildingMOTIF('sqlite://', shacl_engine='topquadrant', log_level=logging.ERROR)\n\n# load 223P library and some dependencies. We will load a recent copy from the open223.info\ns223 = Library.load(ontology_graph=\"https://open223.info/223p.ttl\")\nunit = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/unit\")\nquantitykind = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/quantitykind\")\ntemplates = Library.load(directory=\"BuildingMOTIF/libraries/ashrae/223p/nrel-templates\")\n\n# create a Model to hold our building model\nmodel = Model.create(\"urn:example\")\nBLDG = Namespace(\"urn:example/\")","key":"f4ZCJAJqgH"},{"type":"outputs","id":"NBe23qRQqUqvy4_aP81Cz","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/extras/__init__.py:46: Warning: Extra \"js\" is not satisfied because requirement pyduktape2 is not installed.\n  warn(Warning(f\"Extra \\\"{extra_name}\\\" is not satisfied because requirement {req} is not installed.\"))\n"},"key":"oah59wU1Mx"}],"key":"unczfmcl5O"}],"key":"xN0LV5GFIe"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Building the Model","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"vHYq6awcqq"}],"identifier":"building-the-model","label":"Building the Model","html_id":"building-the-model","implicit":true,"key":"NwJDYrBjKD"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Now, we load the templates into a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"qZ5br5Nj5B"},{"type":"inlineCode","value":"ModelBuilder","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"prblUYuQGO"},{"type":"text","value":" context, which allows us to use the templates to create our model.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"DeJgBF0mOf"}],"key":"XPdPegyaSm"}],"key":"WP4hhqTG9o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"builder = ModelBuilder(BLDG)\nbuilder.add_templates_from_library(templates)","key":"gnTRUXPkMb"},{"type":"outputs","id":"f91V012wfta_fVXZkEw27","children":[],"key":"yWRs2f2jvz"}],"key":"mSBSLJW08N"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"We will create a reheat VAV terminal unit serving a physical space","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"a9mJItMaOu"}],"key":"cepPH71WYt"}],"key":"JscFF2dIMx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a VAV terminal unit with reheat\nvav = builder[\"vav-reheat\"](name=\"my_vav\")\n# we can give names to the sensors inside the VAV\nvav[\"sup-air-temp-sensor\"] = \"BLDG_VAV:SAT\"\nvav[\"sup-air-flow-sensor\"] = \"BLDG_VAV:SAF\"\n\n# create the physical space\nzone = builder[\"hvac-space\"](name=\"my_zone\")\n\n# connect the VAV terminal unit to the zone using a duct\nduct2zone = builder[\"duct\"](a=vav['air-out'], b=zone['in'], name=\"duct2zone\")","key":"a1ObL2lnyG"},{"type":"outputs","id":"qNYG4jOCtav2enyeCngzr","children":[],"key":"zUTbc7d0Fy"}],"key":"xDxXkQveg3"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"When we are done, compile the “builder” into the model","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"yic0YoGo9F"}],"key":"mRT2utMDvW"}],"key":"YtNxLhxr8z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.add_graph(builder.compile())\nprint(f\"Model has {len(model.graph)} triples\")","key":"TOcyiAWr6O"},{"type":"outputs","id":"mYvnVFVNzgX_P5jLSE5-c","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Model has 191 triples\n"},"key":"rbijIInJQX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/buildingmotif/dataclasses/template.py:483: UserWarning: Parameters \"rhc-valve-out, air-out-mapsto, sup-air-temp, sup-air-pressure-sensor, rhc-valve, rhc-valve-command, sup-air-flow, rhc-valve-in-mapsto, sup-air-pressure, rhc-water-in, air-in, air-in-mapsto, dmp-command, rhc-air-in, rhc-supply-water-temp, rhc-water-out, c0, dmp-in-mapsto, rhc-air-out, dmp, rhc-return-water-temp-sensor, rhc-return-water-temp, rhc-water-out-mapsto, rhc-air-in-mapsto, rhc-air-out-mapsto, dmp-in, rhc-supply-water-temp-sensor, rhc-water-in-mapsto, rhc-valve-out-mapsto, dmp-out, dmp-feedback, rhc, rhc-valve-feedback, dmp-out-mapsto, rhc-valve-in\" were not provided during evaluation\n  warnings.warn(\n/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/buildingmotif/dataclasses/template.py:483: UserWarning: Parameters \"in2, in3, in4-mapsto, exhaust-air-flow, in4, out, temp, in2-mapsto, in3-mapsto, relative-humidity, humidity-sensor, out2-mapsto, in-mapsto, sup-flow-sensor, temp-sensor, out-mapsto, out2, exh-flow-sensor, supply-air-flow, physical-space\" were not provided during evaluation\n  warnings.warn(\n"},"key":"iUKZapDmJy"}],"key":"l7hX3zQkel"}],"key":"NiX4s2juGZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"The model is now ready and contains the VAV terminal unit and the physical space it serves:","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"dFsMiEMURD"}],"key":"CfKAeRd7Bk"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model generated from templates","key":"MnEk673nBG"}],"key":"wkgQKnC930"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(model.graph.serialize())","key":"kIkzUTp8F9"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"PIUwnRmDyY"}],"key":"CuMFFD5c3d"}],"key":"VnQudrxBui"}],"key":"lSA0wpw4OE"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Compiling the Model","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"XhvUCGI0sn"}],"identifier":"compiling-the-model","label":"Compiling the Model","html_id":"compiling-the-model","implicit":true,"key":"XzQyxzPdWd"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"The generated model is the “pre-inference” model, as described in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"YXooVVFxsA"},{"type":"link","url":"/model-inference","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Model Inference","key":"TdWv6tlyBS"}],"urlSource":"model_inference.md","dataUrl":"/model-inference.json","internal":true,"protocol":"file","key":"oL5TXy89qx"},{"type":"text","value":".\nTo apply inference rules to this model, we will need to load the 223P ontology and apply the inference rules as described in that document.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"gs5kydvxev"}],"key":"v01lWWjbVo"}],"key":"sVKtaRCCoK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"compiled_model = model.compile([s223.get_shape_collection(), unit.get_shape_collection(), quantitykind.get_shape_collection()])\nprint(f\"Compiled model has {len(compiled_model.graph)} triples\")","key":"bnQlOnNv1X"},{"type":"outputs","id":"rqfAx8mAu5buqo47uXAMF","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Compiled model has 103198 triples\n"},"key":"aIQTTU8aWi"}],"key":"cbH8F7ftdc"}],"key":"j6t8kj2g3G"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model with all inferred triples","key":"sBiachHO5I"}],"key":"CVcsgLNly8"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(compiled_model.graph.serialize())","key":"xQnpVRZbkp"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"qpxj8u4kol"}],"key":"isuM4clDg5"}],"key":"yLSs5noP0y"}],"key":"ST6EkDkycr"}],"key":"VfVupCcF1O"}],"key":"vS7ReUDQII"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Model Inference","url":"/model-inference","group":"Tutorials"},"next":{"title":"Modeling Design Patterns","url":"/design-patterns","group":"Guides"}}},"domain":"http://localhost:3000"}