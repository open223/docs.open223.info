{"version":3,"kind":"Notebook","sha256":"8755ad5579282a31306cd79741f1ea5ec24bc038f4f87fe93f16c6fb0f5991e0","slug":"model-creation-buildingmotif","location":"/tutorials/model_creation_buildingmotif.md","dependencies":[],"frontmatter":{"title":"Creating a Model with BuildingMOTIF","kernelspec":{"name":"open223-book","display_name":"open223-book","language":"python"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst"}},"content_includes_title":false,"github":"https://github.com/open223/docs.open223.info","numbering":{"title":{"offset":1}},"source_url":"https://github.com/open223/docs.open223.info/blob/main/tutorials/model_creation_buildingmotif.md","edit_url":"https://github.com/open223/docs.open223.info/edit/main/tutorials/model_creation_buildingmotif.md","exports":[{"format":"md","filename":"model_creation_buildingmotif.md","url":"/build/model_creation_build-bffb4a3cd0e7404c866fec07d7e88e5e.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://github.com/NREL/BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"N344voIyTb"}],"urlSource":"https://github.com/NREL/BuildingMOTIF","error":true,"key":"f1vblsNnBy"},{"type":"text","value":" is a Python SDK for creating, manipulating, and validating semantic building models.\nHere, we will demonstrate how to create a simple ASHRAE 223P model using BuildingMOTIF.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"x0qdJF9XiJ"}],"key":"yjAM9tTHwI"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"We will create a model that includes a simple HVAC system with a VAV terminal unit serving a zone.\nThis will use BuildingMOTIF ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tcxuXsQ6aj"},{"type":"link","url":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Templates","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"SJvBQ8QqYo"}],"urlSource":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","key":"FYYtT9yK22"},{"type":"text","value":", which are reusable components that encapsulate common patterns in building modeling.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"aY4z0ZfUfo"}],"key":"ui535b4SFe"},{"type":"heading","depth":2,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Setting up BuildingMOTIF","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"S1HBdCoWxX"}],"identifier":"setting-up-buildingmotif","label":"Setting up BuildingMOTIF","html_id":"setting-up-buildingmotif","implicit":true,"key":"D7nMjD5RmA"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Downloading the NREL 223P templates library","key":"q1zOQOuXap"}],"key":"jlxt7OCrdW"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"!git clone --filter=blob:none --no-checkout https://github.com/NREL/BuildingMOTIF\n!pushd BuildingMOTIF && git sparse-checkout init --cone\n!pushd BuildingMOTIF && git sparse-checkout set libraries/ashrae/223p/nrel-templates\n!pushd BuildingMOTIF && git checkout","key":"hXU4I9iCfR"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"c1jM4hFg6d"},{"type":"div","class":"output","children":[],"key":"HPaPEBFIc0"},{"type":"div","class":"output","children":[],"key":"WuCYzr7B2o"},{"type":"div","class":"output","children":[],"key":"tG1RzLy6cK"},{"type":"div","class":"output","children":[],"key":"mTyPPxyPkV"},{"type":"div","class":"output","children":[],"key":"SN5ZqkvPog"},{"type":"div","class":"output","children":[],"key":"MBMd2km35y"},{"type":"div","class":"output","children":[],"key":"Yj9SuZg5B5"},{"type":"div","class":"output","children":[],"key":"rWmrq6opGw"},{"type":"div","class":"output","children":[],"key":"cEp7rufehF"},{"type":"div","class":"output","children":[],"key":"nlqOSdruPx"},{"type":"div","class":"output","children":[],"key":"V3ZKjOXKHp"}],"key":"tjjvxwVxtv"}],"key":"oOFK5I1G7R"}],"key":"us82BiF8jS"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The following code sets up a temporary (in-memory) BuildingMOTIF instance, loads the necessary libraries, and creates an (empty) model to hold our building data.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"GmMdExZodQ"}],"key":"dR4K2Yaggy"}],"key":"CPPqHHfAiE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from rdflib import Namespace\nfrom buildingmotif import BuildingMOTIF\nfrom buildingmotif.dataclasses import Library, Model\nfrom buildingmotif.model_builder import TemplateBuilderContext as ModelBuilder\nimport logging\n\n# Create a BuildingMOTIF object. If you do not have Java installed, remove the \"shacl_engine\" parameter\nbm = BuildingMOTIF('sqlite://', shacl_engine='topquadrant', log_level=logging.ERROR)\n\n# load 223P library and some dependencies. We will load a recent copy from the open223.info\ns223 = Library.load(ontology_graph=\"https://open223.info/223p.ttl\")\nunit = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/unit\")\nquantitykind = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/quantitykind\")\ntemplates = Library.load(directory=\"BuildingMOTIF/libraries/ashrae/223p/nrel-templates\")\n\n# create a Model to hold our building model\nmodel = Model.create(\"urn:example\")\nBLDG = Namespace(\"urn:example/\")","key":"gi0jPaTZyH"},{"type":"outputs","id":"tRMl1PXQT_Y1WX6VPBOnf","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/pyshacl/extras/__init__.py:46: Warning: Extra \"js\" is not satisfied because requirement pyduktape2 is not installed.\n  warn(Warning(f\"Extra \\\"{extra_name}\\\" is not satisfied because requirement {req} is not installed.\"))\n"},"key":"A5QUp8bkwQ"}],"key":"jHWgVYkuHB"}],"key":"xdsbTiTJIE"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Building the Model","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"KvD9DblxrF"}],"identifier":"building-the-model","label":"Building the Model","html_id":"building-the-model","implicit":true,"key":"iYWRFQlDzN"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Now, we load the templates into a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Giu8qpIDTR"},{"type":"inlineCode","value":"ModelBuilder","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"YIuZDpBUBs"},{"type":"text","value":" context, which allows us to use the templates to create our model.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"AJGGQ6rRNV"}],"key":"D47TDbUcCA"}],"key":"tuCR72Otkq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"builder = ModelBuilder(BLDG)\nbuilder.add_templates_from_library(templates)","key":"u1dJv71Q5E"},{"type":"outputs","id":"pxjJCUIW2oNH97nl_9K_W","children":[],"key":"k6f0OHYxe8"}],"key":"e3A6zue3pZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"We will create a reheat VAV terminal unit serving a physical space","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"BA45zsHVFl"}],"key":"eUKRp3pyzz"}],"key":"rSMbfOp0NA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a VAV terminal unit with reheat\nvav = builder[\"vav-reheat\"](name=\"my_vav\")\n# we can give names to the sensors inside the VAV\nvav[\"sup-air-temp-sensor\"] = \"BLDG_VAV:SAT\"\nvav[\"sup-air-flow-sensor\"] = \"BLDG_VAV:SAF\"\n\n# create the physical space\nzone = builder[\"hvac-space\"](name=\"my_zone\")\n\n# connect the VAV terminal unit to the zone using a duct\nduct2zone = builder[\"duct\"](a=vav['air-out'], b=zone['in'], name=\"duct2zone\")","key":"WepZ9uuD1J"},{"type":"outputs","id":"AXN3Kz9az6suD4iZdd6Qf","children":[],"key":"zz7SPuNGNz"}],"key":"fTI4yw5SlX"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"When we are done, compile the “builder” into the model","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"qqHTZEFON8"}],"key":"bgX7ugvoiE"}],"key":"Hjawr5lFCg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.add_graph(builder.compile())\nprint(f\"Model has {len(model.graph)} triples\")","key":"RlfbAPCyWB"},{"type":"outputs","id":"lf7EOJXWTjbPYg-DIt3Ik","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Model has 191 triples\n"},"key":"FH3nDoqyZz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/buildingmotif/dataclasses/template.py:483: UserWarning: Parameters \"rhc, dmp-command, rhc-air-in, rhc-air-out, sup-air-temp, rhc-valve-out-mapsto, dmp, sup-air-flow, dmp-in, dmp-in-mapsto, air-in, air-in-mapsto, rhc-air-out-mapsto, sup-air-pressure, rhc-return-water-temp-sensor, rhc-valve-command, rhc-valve, rhc-valve-in-mapsto, rhc-supply-water-temp-sensor, dmp-out-mapsto, dmp-feedback, dmp-out, rhc-return-water-temp, air-out-mapsto, rhc-water-out-mapsto, rhc-valve-feedback, c0, rhc-water-in-mapsto, rhc-valve-in, rhc-air-in-mapsto, sup-air-pressure-sensor, rhc-water-in, rhc-valve-out, rhc-supply-water-temp, rhc-water-out\" were not provided during evaluation\n  warnings.warn(\n/home/runner/work/docs.open223.info/docs.open223.info/.venv/lib/python3.12/site-packages/buildingmotif/dataclasses/template.py:483: UserWarning: Parameters \"out2, in2-mapsto, in4-mapsto, out-mapsto, temp, exhaust-air-flow, humidity-sensor, supply-air-flow, in2, in3-mapsto, physical-space, in4, out2-mapsto, exh-flow-sensor, sup-flow-sensor, in3, in-mapsto, relative-humidity, temp-sensor, out\" were not provided during evaluation\n  warnings.warn(\n"},"key":"HLh7LAaz2q"}],"key":"MJm4QcY365"}],"key":"ytp5s5I6b2"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"The model is now ready and contains the VAV terminal unit and the physical space it serves:","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"BDIuvy0QHa"}],"key":"S1RerR6OkX"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model generated from templates","key":"dgQ1gRrjlE"}],"key":"qQ58vKV4es"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(model.graph.serialize())","key":"bsboiBYzIn"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"aIcUN7EzrL"}],"key":"FpflJaGBzK"}],"key":"oWr0FfPRmX"}],"key":"zAfpuWDZue"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Compiling the Model","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"kf0uP0742F"}],"identifier":"compiling-the-model","label":"Compiling the Model","html_id":"compiling-the-model","implicit":true,"key":"JdXANYnlN7"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"The generated model is the “pre-inference” model, as described in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Z0wiJpvrYy"},{"type":"link","url":"/model-inference","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Model Inference","key":"aXVUx5qNE9"}],"urlSource":"model_inference.md","dataUrl":"/model-inference.json","internal":true,"protocol":"file","key":"csfLNJxIZW"},{"type":"text","value":".\nTo apply inference rules to this model, we will need to load the 223P ontology and apply the inference rules as described in that document.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"tLRA6Hh1nL"}],"key":"tnlsEbOkAY"}],"key":"ULezpfptGh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"compiled_model = model.compile([s223.get_shape_collection(), unit.get_shape_collection(), quantitykind.get_shape_collection()])\nprint(f\"Compiled model has {len(compiled_model.graph)} triples\")","key":"hoKQmAr7LM"},{"type":"outputs","id":"s5DlLWD3MChDz9g4AvXY0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Compiled model has 103198 triples\n"},"key":"b5TLEU6aq5"}],"key":"HiZ7dyXqGT"}],"key":"N0VtqdgENj"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model with all inferred triples","key":"WciFTmcRzX"}],"key":"f2qB0l3RS2"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(compiled_model.graph.serialize())","key":"GLHTUmrFUu"},{"type":"div","children":[{"type":"div","class":"output","children":[],"key":"MhfBL3SfkU"}],"key":"H786LnOQTs"}],"key":"asYJITdJrJ"}],"key":"XYJcaGvG82"}],"key":"JOLp63GqWx"}],"key":"WMtMTFXRpp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Model Inference","url":"/model-inference","group":"Tutorials"},"next":{"title":"Modeling Design Patterns","url":"/design-patterns","group":"Guides"}}},"domain":"http://localhost:3000"}