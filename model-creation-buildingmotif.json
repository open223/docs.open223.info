{"version":3,"kind":"Notebook","sha256":"8755ad5579282a31306cd79741f1ea5ec24bc038f4f87fe93f16c6fb0f5991e0","slug":"model-creation-buildingmotif","location":"/tutorials/model_creation_buildingmotif.md","dependencies":[],"frontmatter":{"title":"Creating a Model with BuildingMOTIF","kernelspec":{"name":"open223-book","display_name":"open223-book","language":"python"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst"}},"content_includes_title":false,"github":"https://github.com/open223/docs.open223.info","numbering":{"title":{"offset":1}},"source_url":"https://github.com/open223/docs.open223.info/blob/main/tutorials/model_creation_buildingmotif.md","edit_url":"https://github.com/open223/docs.open223.info/edit/main/tutorials/model_creation_buildingmotif.md","exports":[{"format":"md","filename":"model_creation_buildingmotif.md","url":"/build/model_creation_build-9bacdff72b0f332272e8f166f95c8c84.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"https://github.com/NREL/BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"BuildingMOTIF","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"SNUa6C49p0"}],"urlSource":"https://github.com/NREL/BuildingMOTIF","error":true,"key":"tf9ZtzhZaI"},{"type":"text","value":" is a Python SDK for creating, manipulating, and validating semantic building models.\nHere, we will demonstrate how to create a simple ASHRAE 223P model using BuildingMOTIF.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mPUZc5LDmg"}],"key":"R4kv4gShXP"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"We will create a model that includes a simple HVAC system with a VAV terminal unit serving a zone.\nThis will use BuildingMOTIF ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xQwmTIMoSY"},{"type":"link","url":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Templates","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wPULy5nnAR"}],"urlSource":"https://buildingmotif.readthedocs.io/en/latest/explanations/templates.html","key":"nykHnmbcuU"},{"type":"text","value":", which are reusable components that encapsulate common patterns in building modeling.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Ov2zWAkyF8"}],"key":"gTNNsBVEw8"},{"type":"heading","depth":2,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Setting up BuildingMOTIF","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"AAbIfBLGkE"}],"identifier":"setting-up-buildingmotif","label":"Setting up BuildingMOTIF","html_id":"setting-up-buildingmotif","implicit":true,"key":"IFPZSbnkV4"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Downloading the NREL 223P templates library","key":"aD2l9i58kq"}],"key":"n2yaHGzMdO"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"!git clone --filter=blob:none --no-checkout https://github.com/NREL/BuildingMOTIF\n!pushd BuildingMOTIF && git sparse-checkout init --cone\n!pushd BuildingMOTIF && git sparse-checkout set libraries/ashrae/223p/nrel-templates\n!pushd BuildingMOTIF && git checkout","key":"ox0PtQcYzb"},{"type":"div","children":[],"key":"JAnpY5EKXm"}],"key":"ENhqaLAsKg"}],"key":"k5xlxPoY5N"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The following code sets up a temporary (in-memory) BuildingMOTIF instance, loads the necessary libraries, and creates an (empty) model to hold our building data.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"MArfD64iIs"}],"key":"td20ueEsKw"}],"key":"NQriLX4iEW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from rdflib import Namespace\nfrom buildingmotif import BuildingMOTIF\nfrom buildingmotif.dataclasses import Library, Model\nfrom buildingmotif.model_builder import TemplateBuilderContext as ModelBuilder\nimport logging\n\n# Create a BuildingMOTIF object. If you do not have Java installed, remove the \"shacl_engine\" parameter\nbm = BuildingMOTIF('sqlite://', shacl_engine='topquadrant', log_level=logging.ERROR)\n\n# load 223P library and some dependencies. We will load a recent copy from the open223.info\ns223 = Library.load(ontology_graph=\"https://open223.info/223p.ttl\")\nunit = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/unit\")\nquantitykind = Library.load(ontology_graph=\"http://qudt.org/3.1.1/vocab/quantitykind\")\ntemplates = Library.load(directory=\"BuildingMOTIF/libraries/ashrae/223p/nrel-templates\")\n\n# create a Model to hold our building model\nmodel = Model.create(\"urn:example\")\nBLDG = Namespace(\"urn:example/\")","key":"saTzKTbr4k"},{"type":"outputs","id":"TAlnUmUeVDJyrmzgnTpU0","children":[],"key":"vZqoeqZfi3"}],"key":"uWVPOJf8rv"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Building the Model","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"whEkhJM5l5"}],"identifier":"building-the-model","label":"Building the Model","html_id":"building-the-model","implicit":true,"key":"BCiSkaa0Bw"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Now, we load the templates into a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"xBmuhfFs23"},{"type":"inlineCode","value":"ModelBuilder","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"hJ3yIXGSRK"},{"type":"text","value":" context, which allows us to use the templates to create our model.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"fcwKojBWeY"}],"key":"mrG1A7PsRM"}],"key":"elw9bjHEqH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"builder = ModelBuilder(BLDG)\nbuilder.add_templates_from_library(templates)","key":"RscbncOkP8"},{"type":"outputs","id":"Wh_lPXeHD0QcMHJzwzZbj","children":[],"key":"gc0EIkusPt"}],"key":"pJkdvL1PEw"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"We will create a reheat VAV terminal unit serving a physical space","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"fV1SN7Y4hP"}],"key":"ynX5dm324r"}],"key":"j9kO5dsD8f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a VAV terminal unit with reheat\nvav = builder[\"vav-reheat\"](name=\"my_vav\")\n# we can give names to the sensors inside the VAV\nvav[\"sup-air-temp-sensor\"] = \"BLDG_VAV:SAT\"\nvav[\"sup-air-flow-sensor\"] = \"BLDG_VAV:SAF\"\n\n# create the physical space\nzone = builder[\"hvac-space\"](name=\"my_zone\")\n\n# connect the VAV terminal unit to the zone using a duct\nduct2zone = builder[\"duct\"](a=vav['air-out'], b=zone['in'], name=\"duct2zone\")","key":"Fe7vwPVBsT"},{"type":"outputs","id":"TI5EVcKlXs5PCHpTBmwyj","children":[],"key":"M1fLhoh629"}],"key":"HphIOcZTdg"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"When we are done, compile the “builder” into the model","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"vuOv16zsnS"}],"key":"gXRs2dkUEz"}],"key":"AG4YCpCMb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.add_graph(builder.compile())\nprint(f\"Model has {len(model.graph)} triples\")","key":"BtKQAdd6ia"},{"type":"outputs","id":"k6ZpE3PHpKL-_URBVzFQh","children":[],"key":"P6DVIBSboy"}],"key":"Bvnqxn2Hf5"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"The model is now ready and contains the VAV terminal unit and the physical space it serves:","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"gWCuAEnd2z"}],"key":"xRosyk8oqH"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model generated from templates","key":"ClLeLYmGUK"}],"key":"dzrU8AI6VQ"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(model.graph.serialize())","key":"uqQqqWmrhr"},{"type":"div","children":[],"key":"ywAA45Pdo7"}],"key":"D6H2Wc27IG"}],"key":"kYyWqNnWJP"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Compiling the Model","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"c6pyGYClG4"}],"identifier":"compiling-the-model","label":"Compiling the Model","html_id":"compiling-the-model","implicit":true,"key":"FowGAqqAYl"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"The generated model is the “pre-inference” model, as described in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"L7bEVee5gI"},{"type":"link","url":"/model-inference","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Model Inference","key":"JDyVNmrT8J"}],"urlSource":"model_inference.md","dataUrl":"/model-inference.json","internal":true,"protocol":"file","key":"pra9UwK2lv"},{"type":"text","value":".\nTo apply inference rules to this model, we will need to load the 223P ontology and apply the inference rules as described in that document.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"tKCl65A4ly"}],"key":"X2C1oXb6h2"}],"key":"vlWt2va1Eu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"compiled_model = model.compile([s223.get_shape_collection(), unit.get_shape_collection(), quantitykind.get_shape_collection()])\nprint(f\"Compiled model has {len(compiled_model.graph)} triples\")","key":"A9CXeAMLU0"},{"type":"outputs","id":"1kEzCNggEAVMdpMtJmPUd","children":[],"key":"oEsmmrPPqU"}],"key":"J004B1MAYi"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"223P model with all inferred triples","key":"kMAKFPhaGX"}],"key":"zoDRVcJh1J"},{"type":"div","class":"block","children":[{"type":"code","lang":"python","meta":null,"value":"print(compiled_model.graph.serialize())","key":"rAdrAu9qgr"},{"type":"div","children":[],"key":"fYlLknRcmu"}],"key":"BosgVAxIYD"}],"key":"ftFK8o3UW7"}],"key":"kOd7mhCptO"}],"key":"wKEvTANPJK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Model Inference","url":"/model-inference","group":"Tutorials"},"next":{"title":"Modeling Design Patterns","url":"/design-patterns","group":"Guides"}}},"domain":"http://localhost:3000"}